\documentclass{article}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{imakeidx}

\makeindex % Enables index creation

\lstset{
  language=C++, 
  basicstyle=\ttfamily\small, 
  keywordstyle=\color{blue}, 
  commentstyle=\color{gray},  
  stringstyle=\color{green!50!black}, 
  numbers=none,
  frame=none
}

\begin{document}

\begin{lstlisting}
display.begin(SSD1306_SWITCHCAPVCC, 0x3C);
display.display();
\end{lstlisting}

\begin{center}
    Code-Snippet \ref{codesnippet:display} : Display start
\end{center}

\index{Code-Snippet \ref{codesnippet:display} - Display start} % Adds to index
\label{codesnippet:display}

\newpage % Ensures index appears at the end

\printindex % Prints the index

\end{document}
